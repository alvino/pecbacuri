{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_list %}

{% load admin_modify %} 

{% load widget_tweaks %}

{% block content %}

<div id="content-main">
    <form action="" method="post">
        {% csrf_token %}
        
        <div class="module">
            <h2>Confirmação da Movimentação de Pasto</h2>
            <p>Você está prestes a movimentar os seguintes {{ queryset.count }} animal(is). Selecione o pasto/lote de destino:</p>

            <div class="form-row">
                {{ action_form.pasto_destino.label_tag }}
                {{ action_form.pasto_destino|add_class:"form-select" }}
                {% if action_form.pasto_destino.errors %}{{ action_form.pasto_destino.errors }}{% endif %}
            </div>

            <div class="form-row">
                {{ action_form.data_entrada.label_tag }}
                {{ action_form.data_entrada|add_class:"form-select" }}
                {% if action_form.data_entrada.errors %}{{ action_form.data_entrada.errors }}{% endif %}
            </div>
            
            <div class="form-row">
                {{ action_form.observacoes.label_tag }}
                {{ action_form.observacoes |add_class:"form-select"}}
                {% if action_form.observacoes.errors %}{{ action_form.observacoes.errors }}{% endif %}
            </div>
            
            <input type="hidden" name="action" value="{{ action_name }}">
            {% for animal in queryset %}
                <input type="hidden" name="{{ action_checkbox_name }}" value="{{ animal.pk }}">
            {% endfor %}
            <div class="submit-row">
                <button type="submit" name="apply" class="btn btn-primary" title="Executar a movimentação de lote">
                    <i class="fas fa-truck"></i> Confirmar Movimentação
                </button>
                <a href="{% url 'admin:ControleRebanho_animal_changelist' %}" class="btn btn-secondary active">
                    <i class="fas fa-times"></i> Cancelar
                </a>
            </div>
            <div class="module">
                <h3>Animais Selecionados</h3>
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th scope="col">Identificação</th>
                                <th scope="col">Pasto Atual</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for animal in queryset %}
                            <tr>
                                <td>
                                    <a href="{% url opts|admin_urlname:'change' animal.pk|admin_urlquote %}" class="text-primary fw-bold">
                                        {{ animal.identificacao }}
                                    </a>
                                </td>
                                <td>{{ animal.pasto_atual.nome|default:"(N/A)" }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            

        </div>
    </form>
</div>



{{ form.media }}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
{% endblock content %}
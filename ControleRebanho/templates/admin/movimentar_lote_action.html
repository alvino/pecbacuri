{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_list %}

{% load admin_modify %} 

{% load widget_tweaks %}

{% block content %}
    <div id="content-main">
        <form action="" method="post">
            {% csrf_token %}
            
            <div class="module">
                <h2>Confirmação da Ação: {{ title }}</h2>
                <p>Você selecionou os seguintes {{ queryset.count }} animal(is):</p>

                <div class="form-row">
                    {% for field in action_form %}
                        <div class="fieldWrapper">
                            {{ field.errors }}
                            {{ field.label_tag }}
                            {{ field |add_class:"form-select"}}
                            {% if field.help_text %}
                                <p class="help">{{ field.help_text|safe }}</p>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>

                <div class="submit-row my-4">
                    <button type="submit" name="apply" class="btn btn-primary" title="Executar a Ação">
                        <i class="fas fa-check"></i> Confirmar
                    </button>
                    <a href="{% url 'admin:ControleRebanho_animal_changelist' %}" class="btn btn-secondary active">
                        <i class="fas fa-times"></i> Cancelar
                    </a>
                </div>

                <div class="module">
                    <h3>Itens Selecionados</h3>
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th scope="col">Identificação</th>
                                    <th scope="col">Pasto Atual</th>
                                    <th scope="col">Lote Atual</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for animal in queryset %}
                                <tr>
                                    <td>
                                        <a href="{% url opts|admin_urlname:'change' animal.pk %}" class="text-primary fw-bold">
                                            {{ animal.identificacao }}
                                        </a>
                                    </td>
                                    <td>{{ animal.pasto_atual.nome|default:"(N/A)" }}</td>
                                    <td>{{ animal.lote_atual.nome|default:"(N/A)" }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>

                <input type="hidden" name="action" value="{{ action_name }}"> 
                
                {% for animal in queryset %}
                    <input type="hidden" name="{{ action_checkbox_name }}" value="{{ animal.pk }}">
                {% endfor %}

               

            </div>
        </form>
    </div>

    {{ form.media }}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
{% endblock %}